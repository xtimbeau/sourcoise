<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Exec a script and cache results on disk • sourcoise</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Exec a script and cache results on disk">
<meta name="description" content="sourcoise provides a function that behave nearly as base::source() but implements a caching mechanism on disk. It allows to quasi source() R scripts that gather data but can fail or consume to much time to respond even if nothing new is expected. It comes with a bunch of tools to check and execute on demand or when cache is invalid the script.">
<meta property="og:description" content="sourcoise provides a function that behave nearly as base::source() but implements a caching mechanism on disk. It allows to quasi source() R scripts that gather data but can fail or consume to much time to respond even if nothing new is expected. It comes with a bunch of tools to check and execute on demand or when cache is invalid the script.">
<meta property="og:image" content="https://xtimbeau.github.io/sourcoise/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">sourcoise</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/sourcoise.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/advanced.html">Usages avancés</a></li>
    <li><a class="dropdown-item" href="articles/compared.html">Comparé à ...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="sourcoise-">sourcoise 
<a class="anchor" aria-label="anchor" href="#sourcoise-"></a>
</h1>
</div>
<p><a href="https://xtimbeau.github.io/sourcoise">sourcoise</a> is a package that provides tools for running an R script and caching the results. The aim is to be able to very quickly execute code that accesses files or an API and which, in the absence of updates, always produces the same result. When the API is likely to block (or if you don’t have an internet connection), this avoids blocking the rendering of a document or a quarto site.</p>
<p>It also means that the script code that retrieves the data from a file has to be isolated to improve reproducibility. <code><a href="reference/sourcoise.html">sourcoise()</a></code> can be called in a <code><a href="reference/sourcoise.html">sourcoise()</a></code> which allows modularity. It provides tools for checking the cache and refreshing it on demand.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p><a href="https://xtimbeau.github.io/sourcoise">sourcoise</a> can be installed from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"sourcoise"</span><span class="op">)</span></span></code></pre></div>
<p>The development version can be installed from <em>github</em>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_gitub</span><span class="op">(</span><span class="st">"xtimbeau/sourcoise"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># alternativement</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"xtimbeau/sourcoise"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="use">Use<a class="anchor" aria-label="anchor" href="#use"></a>
</h2>
<p>To populate a graph or table with data, put the code in a script <code>r</code> (<code>"mon_script.r"</code>), ending the script with a <code>return(data_pour_le_graphique)</code>. In the <code>.qmd</code> or <code>.rmd</code> (or also an <code>R</code> script) we have the instructions for the graph in a <code>r</code> code chunk:</p>
<pre class="qmd"><code>```{r}
library(tidyverse)
library(sourcoise)

mes_datas &lt;- sourcoise("mon_script.r")
ggplot(mes_datas) + &lt;&lt;graph code&gt;&gt;

```</code></pre>
<p>The first time the script is run, subsequent calls will use the cache, unless the cache is invalidated.</p>
</div>
<div class="section level2">
<h2 id="benefits">Benefits<a class="anchor" aria-label="anchor" href="#benefits"></a>
</h2>
<p>There are many benefits:</p>
<ol style="list-style-type: decimal">
<li><p>time savings when code execution takes a long time (accessing an API, downloading large amounts of data, major processing). Reading an excel file can also take a long time. The time taken to access cached data depends on its size, but even for large data (and there’s no reason why it should be that large), the order of magnitude is a few milliseconds, thanks to optimization.</p></li>
<li><p>the cache is transferable via <em>github</em>. It’s in a (hidden) folder, but saved in the project folder and <em>committed</em> by github. The cache produced on a workstation can therefore be accessed via <code>pull</code> on other workstations, without the need to reexecute the code.</p></li>
<li><p>if the source code triggers an error, you can override it: In the case of a package that is not installed, missing data (for example, an absolute path in the code), or an API that blocks (such as that of the OECD), then <code><a href="reference/sourcoise.html">sourcoise()</a></code> tries to take the result of the last successful execution (if cached). Although this can be problematic, i.e. an unreported error, it has the enormous advantage of not blocking the process and allowing the error to be handled in parallel.</p></li>
<li><p><code><a href="reference/sourcoise.html">sourcoise()</a></code> cleverly searches for the source file in the project and executes the code in a local environment, changing the working directory to the one where the source code is located. This makes it possible to call the source code (the script <code>r</code> <code>mon_script.r</code> passed as a parameter to <code>sourcoise("mon_script.r")</code> scripts <code>r</code> data files <code>.csv</code> or <code>.xlsx</code> which are saved in the same directory as the <code>mon_script.r</code>. You can therefore reuse the code without having to worry about modifying the paths, which are relative to the folder where <code>mon_script.r</code> is.</p></li>
<li><p>This provides an embryo of reproducibility by designating the script that produces the data and thus allowing to complement the code chunk with a reference to reproduce it.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="coming-soon">Coming soon<a class="anchor" aria-label="anchor" href="#coming-soon"></a>
</h2>
<p>Coming soon:</p>
<ul>
<li><p>the ability to store hidden data outside of the project folder (and therefore outside of <em>github</em>) and to use <a href="https://pins.rstudio.com/" class="external-link">pins</a> for stcokage (but perhaps at the cost of slower access).</p></li>
<li><p>a schema for declaring dependencies between calls to <code><a href="reference/sourcoise.html">sourcoise()</a></code> calls and trigger cascade executions.</p></li>
<li><p>a in-mem cache mechanism (trhough <a href="https://memoise.r-lib.org" class="external-link">memoise</a> ?) to further accelerate access (although the performance gain is not necesserly needed).</p></li>
<li><p>and possibly a <em>shiny</em> update interface (<em>gui</em> for <code><a href="reference/sourcoise_refresh.html">sourcoise_refresh()</a></code>)</p></li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing sourcoise</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Xavier Timbeau <br><small class="roles"> Author, maintainer, copyright holder </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Xavier Timbeau.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
