<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Refresh sourcoise cache by executing sources selected — sourcoise_refresh • sourcoise</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Refresh sourcoise cache by executing sources selected — sourcoise_refresh"><meta name="description" content="All scripts (passed to sourcoise_refresh()) are executed with logging enabled."><meta property="og:description" content="All scripts (passed to sourcoise_refresh()) are executed with logging enabled."><meta property="og:image" content="https://xtimbeau.github.io/sourcoise/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sourcoise</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/sourcoise.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/advanced.html">Usages avancés</a></li>
    <li><a class="dropdown-item" href="../articles/compared.html">Comparé à ...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/xtimbeau/sourcoise/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Refresh sourcoise cache by executing sources selected</h1>
      <small class="dont-index">Source: <a href="https://github.com/xtimbeau/sourcoise/blob/main/R/sourcoise_refresh.R" class="external-link"><code>R/sourcoise_refresh.R</code></a></small>
      <div class="d-none name"><code>sourcoise_refresh.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>All scripts (passed to <code>sourcoise_refresh()</code>) are executed with logging enabled.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sourcoise_refresh</span><span class="op">(</span></span>
<span>  what <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  force_exec <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  unfreeze <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  init_fn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"sourcoise.init_fn"</span><span class="op">)</span>,</span>
<span>  root <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"sourcoise.root"</span><span class="op">)</span>,</span>
<span>  log <span class="op">=</span> <span class="st">"INFO"</span>,</span>
<span>  .progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-what">what<a class="anchor" aria-label="anchor" href="#arg-what"></a></dt>
<dd><p>(tibble) a tibble as generated by <code><a href="sourcoise_status.html">sourcoise_status()</a></code>, possibly filtered, (defaut to <code>source_status()</code> )</p></dd>


<dt id="arg-force-exec">force_exec<a class="anchor" aria-label="anchor" href="#arg-force-exec"></a></dt>
<dd><p>(boolean) (default <code>FALSE</code>) if <code>TRUE</code> code is executed, no matter what is cached</p></dd>


<dt id="arg-unfreeze">unfreeze<a class="anchor" aria-label="anchor" href="#arg-unfreeze"></a></dt>
<dd><p>(boolean) (default <code>TRUE</code>) when possible, unfreeze and uncache .qmd files in a quarto project when data used by those .qmd has been refreshed</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>(boolean) (default <code>FALSE</code>) no message if TRUE</p></dd>


<dt id="arg-init-fn">init_fn<a class="anchor" aria-label="anchor" href="#arg-init-fn"></a></dt>
<dd><p>(function) (default <code>NULL</code>) execute a function before sourcing to allow initialization</p></dd>


<dt id="arg-root">root<a class="anchor" aria-label="anchor" href="#arg-root"></a></dt>
<dd><p>(default <code>NULL</code>) force root to be set, instead of letting the function finding the root, for advanced uses</p></dd>


<dt id="arg-log">log<a class="anchor" aria-label="anchor" href="#arg-log"></a></dt>
<dd><p>(character) (default <code>"INFO"</code>) log levels as in <code><a href="https://daroczig.github.io/logger/reference/log_threshold.html" class="external-link">logger::log_threshold()</a></code> (c("OFF", "INFO", ...)), comes with a small performance cost</p></dd>


<dt id="arg--progress">.progress<a class="anchor" aria-label="anchor" href="#arg--progress"></a></dt>
<dd><p>(boolean) (default <code>TRUE</code>) displays a progression bar based on previous execution timings</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list of r scripts (characters) executed, with timing and success and a side effect on caches</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function returns the list of script executed but its main effect is a side-effect as scripts are executed and caches updates accordingly.
Note also that log files reflect execution and track possible errors.
Because of logging the execution comes with a loss in performance, which is not an issue if scripts are long to execute.</p>
<p>It is possible to execute <code>sourcoise_refresh()</code> without execution forcing (<code>force_exec=FALSE</code>) or with it.
Forced execution means that the script is executed even if the cache is valid.
In the case of non forced execution, execution is triggered by other cache invalidation tests (change in source file, lapse or tacked files).</p>
<p>When scripts are linked to qmds (i.e. when run in a quarto project), it is possible to unfreeeze and uncache those qmds with the option <code>unfreeze=TRUE</code>.
This allows to refresh the cahe and then render the qmds using the new data.</p>
<p>It is possible to pass to refresh a function that will be executed before every script. This allows to load packages and declare global variables that can be used in each script.
If packages are loaded inside the script, then this is not needed.</p>
<p>Parameters registered ins <code><a href="sourcoise_status.html">sourcoise_status()</a></code> such as <code>wd</code> or <code>args</code> are used to execute the script.</p>
<p>Defining a <code>priority</code> in <code><a href="sourcoise.html">sourcoise()</a></code>, will change the order of execution of refresh. This allows to execute first data that will be used then inside another script with <code><a href="sourcoise.html">sourcoise()</a></code>. When a <code>sourcoise("something.r", force_exec=TRUE)</code> is run, inside calls to <code><a href="sourcoise.html">sourcoise()</a></code> are <em>not</em> forced. <code>priority</code> is a crude way – yet efficient – to achieve a correct execution with up to date data. Of course, all calls to <code><a href="sourcoise.html">sourcoise()</a></code> of the same script should set the same level of priority as the last executed will be kept, with no verification done, so left to the responsability of the user.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other sourcoise:
<code><a href="sourcoise.html">sourcoise</a>()</code>,
<code><a href="sourcoise_clear.html">sourcoise_clear</a>()</code>,
<code><a href="sourcoise_reset.html">sourcoise_reset</a>()</code>,
<code><a href="sourcoise_status.html">sourcoise_status</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="set_sourcoise_root.html">set_sourcoise_root</a></span><span class="op">(</span><span class="va">dir</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/tmp/RtmpJqloj8"</span>
<span class="r-in"><span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/copy.html" class="external-link">file_copy</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/path_package.html" class="external-link">path_package</a></span><span class="op">(</span><span class="st">"sourcoise"</span>, <span class="st">"ipch"</span>, <span class="st">"prix_insee.R"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="va">dir</span>,</span></span>
<span class="r-in"><span>   overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Force execution</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="sourcoise.html">sourcoise</a></span><span class="op">(</span><span class="st">"prix_insee.R"</span>, force_exec <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># we then refresh all caches</span></span></span>
<span class="r-in"><span><span class="fu">sourcoise_refresh</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">prix_insee.r</span> executed in 0 s. for 14 kB of data</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Total refresh in 0 seconds for 14 kB of data</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Xavier Timbeau. hand made with love in France</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

